---
title: "Homework 2"
author: "Pangsibo Shen"
date: "9/24/2020"
output: github_document
---

```{r}
library(tidyverse)
library(readxl)
```

## Problem 1

Read the Mr. Trashwheel dataset

```{r}
trashwheel_df =
  read_xlsx(
    "./data/Trash-Wheel-Collection-Totals-7-2020-1.xlsx",
    sheet = "Mr. Trash Wheel",
    range = cell_cols("A:N")) %>%
  janitor::clean_names() %>%
  drop_na(dumpster) %>%
  mutate(
    sports_balls = round(sports_balls),
    sports_balls = as.integer(sports_balls)
  )
```

Read precipitation data

```{r}
precip_2018 =
  read_xlsx(
    "./data/Trash-Wheel-Collection-Totals-7-2020-1.xlsx",
    sheet = "2018 Precipitation",
    skip = 1)%>%
  janitor::clean_names() %>%
  drop_na(month) %>%
  mutate(year = 2018) %>%
  relocate(year)

precip_2017 =
  read_xlsx(
    "./data/Trash-Wheel-Collection-Totals-7-2020-1.xlsx",
    sheet = "2017 Precipitation",
    skip = 1)%>%
  janitor::clean_names() %>%
  drop_na(month) %>%
  mutate(year = 2017) %>%
  relocate(year)
```

Now combine annual precipitation.

```{r}
month_df = 
  tibble(
    month = 1:12,
    month_name = month.name
  )

precip_df =
  bind_rows(precip_2018,precip_2017) 

left_join(precip_df, month_df, by = "month")
```

This dataset contains information from the Mr. Trashwheel trash collector in Baltimore, Maryland. As trash enters the inner harbor, the trashwheel collects that trash, and stores it in a dumpster. The dataset contains information on year, month, and trash collected, include some specific kinds of trash. There are a total of `r nrow(trashwheel_df)` rows in our final dataset. Additional data sheets include month precipitation data. 

## Problem 2

Read and clean the NYC Subway dataset

```{r}
nyc_subway = read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv")%>%
  janitor::clean_names()%>%
  transform(route8 = as.character(route8),
          route9 = as.character(route9),
          route10 = as.character(route10),
          route11 = as.character(route11))%>%
  pivot_longer(route1:route11,
               names_to = "route_number",
               values_to = "route_names"
  )%>%
  drop_na(route_names)%>%
  select(c("line","station_name","station_latitude","station_longitude","route_number","route_names","entry", "vending", "entrance_type","ada"))%>%
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE))%>%
  unique()

head(nyc_subway)
  
```

--------------------------------------

How many distinct stations are there?

```{r}
distinct(nyc_subway, station_name)
#distinct(nyc_subway, line)
#distinct(nyc_subway, route_names)
```
there are `r nrow(distinct(nyc_subway, station_name))` distinct stations.

-------------------------------

How many stations are ADA compliant?

```{r}
nyc_subway%>%
  filter(ada == TRUE)%>%
  distinct(station_name)%>%
  nrow()
```
There are 73 stations with ADA compliant.

---------------------------------------

What proportion of station entrances / exits without vending allow entrance?

```{r}
no_venting = nyc_subway%>%
  filter(vending == "NO")%>%
  nrow() #number of station entrances/exists without vending allow entrance

venting_prop = no_venting/nrow(nyc_subway) 
venting_prop*100 
```
This is 17.77% of station entrances/exits don't have vending allow entrance.

-------------------------------------

 How many distinct stations serve the A train? Of the stations that serve the A train, how many are ADA compliant?
 
 
```{r}
nyc_subway%>%
  filter(route_names == "A")%>%
  distinct(station_name)%>%
  nrow()

nyc_subway%>%
  filter(route_names == "A" & ada == TRUE)%>%
  distinct(station_name)%>%
  nrow()
```
 There are 56 distinct stations serve the A train and 16 of them are ADA compliant. 
 
 
 
 
 
 
 
 
 
 
 
 
 
